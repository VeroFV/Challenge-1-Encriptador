<!DOCTYPE html>

<html>
    <head>
        <meta charset="UTF-8">
        <title>Encriptador</title>
        <link rel="stylesheet" href="style.css">
        <link rel="icon" href="favicon.ico" type="image/x-icon" />
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/34eb2b0d7d.js" crossorigin="anonymous"></script>
        <script>
            var clave = ['ai', 'enter', 'imes', 'ober', 'ufat'];
            var vocales = ['a', 'e', 'i', 'o', 'u'];
            var resultado;

            function pedirmensaje(){
                var output = document.querySelector(".salida");

                var caja = document.createElement('div');
                caja.setAttribute('class', 'cajasinmensaje');
                output.appendChild(caja);

                var sticker = document.createElement("img");
                sticker.setAttribute("class", "perrin");
                sticker.setAttribute("src", "imagenes/dog.gif");
                sticker.setAttribute("alt", "Buscando mensaje");
                caja.appendChild(sticker);

                var h2 = document.createElement("h2");
                h2.textContent = "Ningún mensaje fue encontrado.";
                caja.appendChild(h2);

                var h3 = document.createElement("h3");
                h3.textContent = "Ingrese el texto que desee encriptar o desencriptar.";
                caja.appendChild(h3);
            };

            function encriptar(){
                var text = document.getElementById("mensaje").value;
                resultado = text.replace(/[aeiou]/g, function (x) {
                for (var indice = 0; indice < vocales.length; indice++){
                    if (x == vocales[indice]) {
                        x = clave[indice];
                        break;
                };
                };

                return x;
                });
                console.log(resultado);

            };

            function limpiar(){
                var output = document.querySelector(".salida");
                var borrame = document.querySelector(".salida div");
                output.removeChild(borrame);
            }
            
            function mostrarresultado(){
                var output = document.querySelector(".salida");
                var caja = document.createElement("div");
                caja.setAttribute('class', 'cajaconmensaje');
                output.appendChild(caja);
                
                var panel = document.createElement('p');
                panel.setAttribute('class', 'mensajedesalida');
                panel.setAttribute('id', 'copiame');
                panel.textContent = resultado;
                caja.appendChild(panel);

                var botoncopiar = document.createElement("button");
                botoncopiar.setAttribute("class", "botontransparente");
                botoncopiar.setAttribute('onclick', 'copiar()');
                botoncopiar.textContent = "Copiar";
                caja.appendChild(botoncopiar);
            };

            function copiar(){
                navigator.clipboard.writeText(resultado);
            };

            function usarencriptacion(){
                var text = document.getElementById("mensaje").value;
                limpiar();
                if (/\S/.test(text)){
                    encriptar();
                    mostrarresultado();
                } else {
                    pedirmensaje();
                };
            };


        </script>
    </head>
    <body>
        <header>
            <div class="encabezado">
                <img src="imagenes/logo.png" alt="Logo de Novacerix">
                <h1>Encriptador</h1>
            </div>
        </header>
        <main>
            <div class="principal">
                <div class="entrada">
                    <textarea id="mensaje" class="mensajedeentrada" placeholder="Ingrese texto aquí." onkeypress="return (event.charCode >= 97 && event.charCode <= 122 || event.charCode == 32 || event.charCode == 241)"></textarea>
                </div>
                <div class="botones">
                    <p class="advertencia">
                        <i class="fa-solid fa-circle-exclamation"></i> Solo admite letras minúsculas y sin acentos.
                    </p>
                    <button id="encriptar" class="botonoscuro" onclick="usarencriptacion();">Encriptar</button>
                    <button id="desencriptar" class="botonclaro" onclick='CopyToClipboard("copiame");'>Desencriptar</button>
                </div>
            </div>
            <div class="salida">
                <div class="cajasinmensaje">
                    <img class="perrin" src="imagenes/dog.gif" alt="Buscando mensaje">
                    <h2>Ningún mensaje fue encontrado.</h2>
                    <h3>Ingrese el texto que desee encriptar o desencriptar.</h3>
                </div>
                <!---<p class="mensajedesalida"></p>-->
            </div>
        </main>
        <footer>
        </footer>
    </body>
</html>